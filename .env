const Discord = require('discord.js');
const client = new Discord.Client();
let prefix = '.env ';
let owners = ['306557645479870464', '694963006970527826', '544676649510371328'];

client.on('ready', () => console.log(`${client.user.tag} is ready!`));

client.on('message', async message => {
    if (message.author.bot || !message.content.toLowerCase().startsWith(prefix)) return;
    const user = message.mentions.users.first() || message.author;
    const args = message.content.slice(prefix.length).trim().split(/ +/g);
    const command = args.shift().toLowerCase();
    switch (command.toLowerCase()) {
    case 'help': {
        return message.channel.send('My commands:\n\`serverinfo\`\n\`userinfo\`');
    }
    break;
    case 'serverinfo': {
        return message.channel.send(`Server name: ${Discord.Util.escapeMarkdown(message.guild.name)}\nTotal members: ${message.guild.memberCount.toLocaleString()}`);
    }
    break;
    case 'userinfo': {
        return message.channel.send(`Tag: ${Discord.Util.escapeMarkdown(user.tag)}\nID: ${user.id}`);
    }
    break;
    case 'ping': {
        return message.channel.send('Pinging...').then(sent => sent.edit(`Roundtrip latency: ${sent.createdTimestamp - message.createdTimestamp}ms\nWebsocket heartbeat: ${client.ws.ping}ms.`));
    }
    break;
    case 'eval': {
        if (!owners.includes(message.author.id)) return message.channel.send('Owner only command.');
        if (!args[0]) return message.channel.send('Code required to evaluate.');
        let output;
        try {
          let evaled = eval(args.join(' '));
          if (evaled instanceof Promise) evaled = await evaled;
          function clean(text) {
            return typeof text === 'string' ? text.replace(/(`|@)/g, String.fromCharCode(8203)) : text;
          }
          if (typeof evaled !== 'string') evaled = require('util').inspect(evaled);
          output = clean(evaled);
        } catch (err) {
          output = err;
        }
        return message.channel.send([...output].slice(0, 2048).join(''), {
          code: 'js'
        });
    }
    break;
    case 'ban': {
        let banned = message.mentions.users.first() || client.users.resolve(args[0]);
        if (message.author === banned) {
            let cantbanself = new Discord.MessageEmbed()
              .setDescription(`You cannot ban yourself`)
              .setColor("#2C2F33");
            message.channel.send(cantbanself);
        
            return;
          }
          if (!message.member.permissions.has("BAN_MEMBERS")) {
            let nopermsembed = new Discord.MessageEmbed()
              .setDescription(
                "You do not have permission `BAN MEMBERS`."
              )
              .setColor("#2C2F33");
            message.channel.send(nopermsembed);
        
            return;
          }
        
          if (!message.guild.me.permissions.has("BAN_MEMBERS")) {
            let noperms = new Discord.MessageEmbed()
              .setDescription(
                "I do not have `BAN MEMBERS` permission."
              )
              .setColor("#2C2F33");
            message.channel.send(noperms);
        
            return;
          }
        
          message.guild.members.ban(banned);
        
          let successfullyembed = new Discord.MessageEmbed()
            .setTitle(`${banned.tag} has been successfully banned.`)
            .setColor("#2C2F33");
        
          message.channel.send(successfullyembed);
        }
    break;
    }
});

client.login('tokenn\'t');
